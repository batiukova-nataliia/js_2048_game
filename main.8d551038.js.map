{"version":3,"sources":["scripts/main.js"],"names":["board","score","rowsAmount","columnsAmount","messageStart","document","querySelector","messageWin","messageLose","rows","querySelectorAll","buttonStart","setGame","innerText","forEach","row","rowIndex","children","cell","colIndex","id","appendChild","updateCell","setTwo","classList","add","hasValidMoves","hasEmptyTile","r","c","currentNum","showMessageLose","remove","isWinner","tile","num","value","toString","found","Math","floor","random","getElementById","filterZero","filter","slide","newRow","i","length","push","replaceZeros","slideLeft","slideRight","reverse","slideUp","slideDown","addEventListener","e","code"],"mappings":"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","file":"main.8d551038.js","sourceRoot":"../src","sourcesContent":["'use strict';\n\nlet board;\nlet score = 0;\nconst rowsAmount = 4;\nconst columnsAmount = 4;\nconst messageStart = document.querySelector('.message-start');\nconst messageWin = document.querySelector('.message-win');\nconst messageLose = document.querySelector('.message-lose');\n\nconst rows = document.querySelectorAll('tr');\n\nconst buttonStart = document.querySelector('.start');\n\nbuttonStart.addEventListener('click', () => {\n  setGame();\n  buttonStart.innerText = 'Restart';\n\n  buttonStart.classList.remove(...buttonStart.classList);\n  buttonStart.classList.add('button', 'restart');\n});\n\nfunction setGame() {\n  score = 0;\n  document.querySelector('.game-score').innerText = score;\n\n  board = [\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n  ];\n\n  rows.forEach((row, rowIndex) => {\n    [...row.children].forEach((cell, colIndex) => {\n      cell.id = `${rowIndex}-${colIndex}`;\n\n      row.appendChild(cell);\n\n      const num = board[rowIndex][colIndex];\n\n      updateCell(cell, num);\n\n      if (cell.innerText === '0') {\n        cell.innerText = '';\n      }\n    });\n  });\n\n  setTwo();\n  setTwo();\n  messageStart.classList.add('hidden');\n  messageLose.classList.add('hidden');\n  messageWin.classList.add('hidden');\n}\n\nfunction hasValidMoves() {\n  if (!hasEmptyTile()) {\n    for (let r = 0; r < rowsAmount; r++) {\n      for (let c = 0; c < columnsAmount; c++) {\n        const currentNum = board[r][c];\n\n        if (\n          (r > 0 && board[r - 1][c] === currentNum)\n          || (r < rowsAmount - 1 && board[r + 1][c] === currentNum)\n          || (c > 0 && board[r][c - 1] === currentNum)\n          || (c < columnsAmount - 1 && board[r][c + 1] === currentNum)\n        ) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  return true;\n}\n\nfunction showMessageLose() {\n  if (!hasValidMoves()) {\n    messageLose.classList.remove('hidden');\n  } else {\n    messageLose.classList.add('hidden');\n  }\n}\n\nfunction isWinner() {\n  for (let r = 0; r < rowsAmount; r++) {\n    for (let c = 0; c < columnsAmount; c++) {\n      if (board[r][c] !== 2048) {\n        return false;\n      }\n    }\n  }\n\n  return true;\n}\n\nfunction updateCell(tile, num) {\n  tile.innerText = '';\n  tile.classList.value = '';\n  tile.classList.add('field-cell');\n\n  if (num !== '') {\n    tile.innerText = num.toString();\n\n    if (num <= 1024) {\n      tile.classList.add('field-cell' + `--${num.toString()}`);\n    } else {\n      tile.classList.add('field-cell--2048');\n    }\n  }\n}\n\nfunction hasEmptyTile() {\n  for (let r = 0; r < rowsAmount; r++) {\n    for (let c = 0; c < columnsAmount; c++) {\n      if (board[r][c] === 0) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nfunction setTwo() {\n  if (!hasEmptyTile() || !hasValidMoves()) {\n    return;\n  }\n\n  let found = false;\n\n  while (!found) {\n    const r = Math.floor(Math.random() * 4);\n    const c = Math.floor(Math.random() * 4);\n\n    if (board[r][c] === 0) {\n      board[r][c] = 2;\n\n      const tile = document.getElementById(r.toString() + '-' + c.toString());\n\n      tile.innerText = '2';\n      tile.classList.remove(...tile.classList);\n      tile.classList.add('field-cell', 'field-cell--2');\n      found = true;\n    }\n  }\n}\n\ndocument.addEventListener('keyup', (e) => {\n  if (e.code === 'ArrowLeft') {\n    slideLeft();\n    setTwo();\n  } else if (e.code === 'ArrowRight') {\n    slideRight();\n    setTwo();\n  } else if (e.code === 'ArrowUp') {\n    slideUp();\n    setTwo();\n  } else if (e.code === 'ArrowDown') {\n    slideDown();\n    setTwo();\n  }\n  document.querySelector('.game-score').innerText = score;\n});\n\nfunction filterZero(row) {\n  return row.filter(num => num !== 0);\n}\n\nfunction slide(row) {\n  let newRow = filterZero(row);\n\n  for (let i = 0; i < newRow.length - 1; i++) {\n    if (newRow[i] === newRow[i + 1]) {\n      newRow[i] *= 2;\n      newRow[i + 1] = 0;\n      score += newRow[i];\n    }\n  }\n\n  newRow = filterZero(newRow);\n\n  while (newRow.length < rowsAmount) {\n    newRow.push(0);\n  }\n\n  if (isWinner()) {\n    messageWin.classList.remove('hidden');\n  }\n\n  return newRow;\n}\n\nfunction replaceZeros() {\n  for (let r = 0; r < rowsAmount; r++) {\n    for (let c = 0; c < columnsAmount; c++) {\n      const tile = document.getElementById(r.toString() + '-' + c.toString());\n\n      if (tile.innerText === '0') {\n        tile.innerText = '';\n      }\n    }\n  }\n}\n\nfunction slideLeft() {\n  for (let r = 0; r < rowsAmount; r++) {\n    let row = board[r];\n\n    row = slide(row);\n    board[r] = row;\n\n    for (let c = 0; c < columnsAmount; c++) {\n      const tile = document.getElementById(r.toString() + '-' + c.toString());\n      const num = board[r][c];\n\n      updateCell(tile, num);\n    }\n  }\n  replaceZeros();\n\n  if (!hasValidMoves()) {\n    messageLose.classList.remove('hidden');\n  } else {\n    messageLose.classList.add('hidden');\n  }\n\n  showMessageLose();\n\n  if (isWinner()) {\n    messageWin.classList.remove('hidden');\n  }\n}\n\nfunction slideRight() {\n  for (let r = 0; r < rowsAmount; r++) {\n    let row = board[r];\n\n    row.reverse();\n    row = slide(row);\n    board[r] = row.reverse();\n\n    for (let c = 0; c < columnsAmount; c++) {\n      const tile = document.getElementById(r.toString() + '-' + c.toString());\n      const num = board[r][c];\n\n      updateCell(tile, num);\n    }\n  }\n  replaceZeros();\n\n  showMessageLose();\n\n  if (isWinner()) {\n    messageWin.classList.remove('hidden');\n  }\n}\n\nfunction slideUp() {\n  for (let c = 0; c < rowsAmount; c++) {\n    let row = [board[0][c], board[1][c], board[2][c], board[3][c]];\n\n    row = slide(row);\n\n    for (let r = 0; r < columnsAmount; r++) {\n      board[r][c] = row[r];\n\n      const tile = document.getElementById(r.toString() + '-' + c.toString());\n      const num = board[r][c];\n\n      updateCell(tile, num);\n    }\n  }\n\n  replaceZeros();\n\n  showMessageLose();\n\n  if (isWinner()) {\n    messageWin.classList.remove('hidden');\n  }\n}\n\nfunction slideDown() {\n  for (let c = 0; c < columnsAmount; c++) {\n    let row = [board[0][c], board[1][c], board[2][c], board[3][c]];\n\n    row.reverse();\n    row = slide(row);\n    row.reverse();\n\n    for (let r = 0; r < rowsAmount; r++) {\n      board[r][c] = row[r];\n\n      const tile = document.getElementById(r.toString() + '-' + c.toString());\n      const num = board[r][c];\n\n      updateCell(tile, num);\n    }\n  }\n\n  replaceZeros();\n\n  showMessageLose();\n\n  if (isWinner()) {\n    messageWin.classList.remove('hidden');\n  }\n}\n"]}